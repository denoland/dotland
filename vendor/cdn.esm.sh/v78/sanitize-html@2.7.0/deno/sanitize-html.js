/* esm.sh - esbuild bundle(sanitize-html@2.7.0) deno production */
import __postcss$ from "/v78/postcss@8.4.12/deno/postcss.js";import __parse_srcset$ from "/v78/parse-srcset@1.0.2/deno/parse-srcset.js";import __deepmerge$ from "/v78/deepmerge@4.2.2/deno/deepmerge.js";import * as __is_plain_object$ from "/v78/is-plain-object@5.0.0/deno/is-plain-object.js";import __escape_string_regexp$ from "/v78/escape-string-regexp@4.0.0/deno/escape-string-regexp.js";import __htmlparser2$ from "/v78/htmlparser2@6.1.0/deno/htmlparser2.js";var se=Object.create;var Z=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var fe=Object.getPrototypeOf,ce=Object.prototype.hasOwnProperty;var A=(l=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(l,{get:(e,d)=>(typeof require!="undefined"?require:e)[d]}):l)(function(l){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+l+'" is not supported')});var oe=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var de=(l,e,d,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let u of ae(e))!ce.call(l,u)&&u!==d&&Z(l,u,{get:()=>e[u],enumerable:!(n=ne(e,u))||n.enumerable});return l};var X=(l,e,d)=>(d=l!=null?se(fe(l)):{},de(e||!l||!l.__esModule?Z(d,"default",{value:l,enumerable:!0}):d,l));var z=oe((Se,Q)=>{var ue=__htmlparser2$,Y=__escape_string_regexp$,{isPlainObject:he}=__is_plain_object$,J=__deepmerge$,ge=__parse_srcset$,{parse:me}=__postcss$,pe=["img","audio","video","picture","svg","object","map","iframe","embed"],we=["script","style"];function k(l,e){l&&Object.keys(l).forEach(function(d){e(l[d],d)})}function T(l,e){return{}.hasOwnProperty.call(l,e)}function K(l,e){let d=[];return k(l,function(n){e(n)&&d.push(n)}),d}function xe(l){for(let e in l)if(T(l,e))return!1;return!0}function Te(l){return l.map(function(e){if(!e.url)throw new Error("URL missing");return e.url+(e.w?` ${e.w}w`:"")+(e.h?` ${e.h}h`:"")+(e.d?` ${e.d}x`:"")}).join(", ")}Q.exports=N;var be=/^[^\0\t\n\f\r /<=>]+$/;function N(l,e,d){if(l==null)return"";let n="",u="";function O(t,i){let r=this;this.tag=t,this.attribs=i||{},this.tagPosition=n.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(g.length){let s=g[g.length-1];s.text+=r.text}},this.updateParentNodeMediaChildren=function(){g.length&&pe.includes(this.tag)&&g[g.length-1].mediaChildren.push(this.tag)}}e=Object.assign({},N.defaults,e),e.parser=Object.assign({},ye,e.parser),we.forEach(function(t){e.allowedTags&&e.allowedTags.indexOf(t)>-1&&!e.allowVulnerableTags&&console.warn(`

\u26A0\uFE0F Your \`allowedTags\` option includes, \`${t}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});let te=e.nonTextTags||["script","style","textarea","option"],h,R;e.allowedAttributes&&(h={},R={},k(e.allowedAttributes,function(t,i){h[i]=[];let r=[];t.forEach(function(s){typeof s=="string"&&s.indexOf("*")>=0?r.push(Y(s).replace(/\\\*/g,".*")):h[i].push(s)}),r.length&&(R[i]=new RegExp("^("+r.join("|")+")$"))}));let D={},q={},U={};k(e.allowedClasses,function(t,i){h&&(T(h,i)||(h[i]=[]),h[i].push("class")),D[i]=[],U[i]=[];let r=[];t.forEach(function(s){typeof s=="string"&&s.indexOf("*")>=0?r.push(Y(s).replace(/\\\*/g,".*")):s instanceof RegExp?U[i].push(s):D[i].push(s)}),r.length&&(q[i]=new RegExp("^("+r.join("|")+")$"))});let B={},L;k(e.transformTags,function(t,i){let r;typeof t=="function"?r=t:typeof t=="string"&&(r=N.simpleTransform(t)),i==="*"?L=r:B[i]=r});let m,g,C,M,y,E,F=!1;W();let G=new ue.Parser({onopentag:function(t,i){if(e.enforceHtmlBoundary&&t==="html"&&W(),y){E++;return}let r=new O(t,i);g.push(r);let s=!1,P=!!r.text,p;if(T(B,t)&&(p=B[t](t,i),r.attribs=i=p.attribs,p.text!==void 0&&(r.innerText=p.text),t!==p.tagName&&(r.name=t=p.tagName,M[m]=p.tagName)),L&&(p=L(t,i),r.attribs=i=p.attribs,t!==p.tagName&&(r.name=t=p.tagName,M[m]=p.tagName)),(e.allowedTags&&e.allowedTags.indexOf(t)===-1||e.disallowedTagsMode==="recursiveEscape"&&!xe(C)||e.nestingLimit!=null&&m>=e.nestingLimit)&&(s=!0,C[m]=!0,e.disallowedTagsMode==="discard"&&te.indexOf(t)!==-1&&(y=!0,E=1),C[m]=!0),m++,s){if(e.disallowedTagsMode==="discard")return;u=n,n=""}n+="<"+t,t==="script"&&(e.allowedScriptHostnames||e.allowedScriptDomains)&&(r.innerText=""),(!h||T(h,t)||h["*"])&&k(i,function(f,c){if(!be.test(c)){delete r.attribs[c];return}let S,v=!1;if(!h||T(h,t)&&h[t].indexOf(c)!==-1||h["*"]&&h["*"].indexOf(c)!==-1||T(R,t)&&R[t].test(c)||R["*"]&&R["*"].test(c))v=!0;else if(h&&h[t]){for(let a of h[t])if(he(a)&&a.name&&a.name===c){v=!0;let o="";if(a.multiple===!0){let w=f.split(" ");for(let b of w)a.values.indexOf(b)!==-1&&(o===""?o=b:o+=" "+b)}else a.values.indexOf(f)>=0&&(o=f);f=o}}if(v){if(e.allowedSchemesAppliedToAttributes.indexOf(c)!==-1&&V(t,f)){delete r.attribs[c];return}if(t==="script"&&c==="src"){let a=!0;try{let o=new URL(f);if(e.allowedScriptHostnames||e.allowedScriptDomains){let w=(e.allowedScriptHostnames||[]).find(function(x){return x===o.hostname}),b=(e.allowedScriptDomains||[]).find(function(x){return o.hostname===x||o.hostname.endsWith(`.${x}`)});a=w||b}}catch{a=!1}if(!a){delete r.attribs[c];return}}if(t==="iframe"&&c==="src"){let a=!0;try{if(f=f.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),f.startsWith("relative:"))throw new Error("relative: exploit attempt");let o="relative://relative-site";for(let x=0;x<100;x++)o+=`/${x}`;let w=new URL(f,o);if(w&&w.hostname==="relative-site"&&w.protocol==="relative:")a=T(e,"allowIframeRelativeUrls")?e.allowIframeRelativeUrls:!e.allowedIframeHostnames&&!e.allowedIframeDomains;else if(e.allowedIframeHostnames||e.allowedIframeDomains){let x=(e.allowedIframeHostnames||[]).find(function($){return $===w.hostname}),I=(e.allowedIframeDomains||[]).find(function($){return w.hostname===$||w.hostname.endsWith(`.${$}`)});a=x||I}}catch{a=!1}if(!a){delete r.attribs[c];return}}if(c==="srcset")try{if(S=ge(f),S.forEach(function(a){V("srcset",a.url)&&(a.evil=!0)}),S=K(S,function(a){return!a.evil}),S.length)f=Te(K(S,function(a){return!a.evil})),r.attribs[c]=f;else{delete r.attribs[c];return}}catch{delete r.attribs[c];return}if(c==="class"){let a=D[t],o=D["*"],w=q[t],b=U[t],x=q["*"],I=[w,x].concat(b).filter(function($){return $});if(a&&o?f=_(f,J(a,o),I):f=_(f,a||o,I),!f.length){delete r.attribs[c];return}}if(c==="style")try{let a=me(t+" {"+f+"}"),o=re(a,e.allowedStyles);if(f=ie(o),f.length===0){delete r.attribs[c];return}}catch{delete r.attribs[c];return}n+=" "+c,f&&f.length&&(n+='="'+H(f,!0)+'"')}else delete r.attribs[c]}),e.selfClosing.indexOf(t)!==-1?n+=" />":(n+=">",r.innerText&&!P&&!e.textFilter&&(n+=H(r.innerText),F=!0)),s&&(n=u+H(n),u="")},ontext:function(t){if(y)return;let i=g[g.length-1],r;if(i&&(r=i.tag,t=i.innerText!==void 0?i.innerText:t),e.disallowedTagsMode==="discard"&&(r==="script"||r==="style"))n+=t;else{let s=H(t,!1);e.textFilter&&!F?n+=e.textFilter(s,r):F||(n+=s)}if(g.length){let s=g[g.length-1];s.text+=t}},onclosetag:function(t){if(y)if(E--,!E)y=!1;else return;let i=g.pop();if(!i)return;y=e.enforceHtmlBoundary?t==="html":!1,m--;let r=C[m];if(r){if(delete C[m],e.disallowedTagsMode==="discard"){i.updateParentNodeText();return}u=n,n=""}if(M[m]&&(t=M[m],delete M[m]),e.exclusiveFilter&&e.exclusiveFilter(i)){n=n.substr(0,i.tagPosition);return}if(i.updateParentNodeMediaChildren(),i.updateParentNodeText(),e.selfClosing.indexOf(t)!==-1){r&&(n=u,u="");return}n+="</"+t+">",r&&(n=u+H(n),u=""),F=!1}},e.parser);return G.write(l),G.end(),n;function W(){n="",m=0,g=[],C={},M={},y=!1,E=0}function H(t,i){return typeof t!="string"&&(t=t+""),e.parser.decodeEntities&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(t=t.replace(/"/g,"&quot;"))),t=t.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(t=t.replace(/"/g,"&quot;")),t}function V(t,i){i=i.replace(/[\x00-\x20]+/g,""),i=i.replace(/<!--.*?-->/g,"");let r=i.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!r)return i.match(/^[/\\]{2}/)?!e.allowProtocolRelative:!1;let s=r[1].toLowerCase();return T(e.allowedSchemesByTag,t)?e.allowedSchemesByTag[t].indexOf(s)===-1:!e.allowedSchemes||e.allowedSchemes.indexOf(s)===-1}function re(t,i){if(!i)return t;let r=t.nodes[0],s;return i[r.selector]&&i["*"]?s=J(i[r.selector],i["*"]):s=i[r.selector]||i["*"],s&&(t.nodes[0].nodes=r.nodes.reduce(le(s),[])),t}function ie(t){return t.nodes[0].nodes.reduce(function(i,r){return i.push(`${r.prop}:${r.value}${r.important?" !important":""}`),i},[]).join(";")}function le(t){return function(i,r){return T(t,r.prop)&&t[r.prop].some(function(P){return P.test(r.value)})&&i.push(r),i}}function _(t,i,r){return i?(t=t.split(/\s+/),t.filter(function(s){return i.indexOf(s)!==-1||r.some(function(P){return P.test(s)})}).join(" ")):t}}var ye={decodeEntities:!0};N.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1};N.simpleTransform=function(l,e,d){return d=d===void 0?!0:d,e=e||{},function(n,u){let O;if(d)for(O in e)u[O]=e[O];else u=e;return{tagName:l,attribs:u}}}});var j=X(z()),ee=X(z()),{defaults:$e,simpleTransform:Ae}=ee,{default:Re,...Ce}=ee,Oe=j.default??Re??Ce;export{Oe as default,$e as defaults,Ae as simpleTransform};
